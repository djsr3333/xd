<!DOCTYPE html>
<html>
<head>
  <title>Detector de Color (7x7 con m√°s naranjas)</title>
  <style>
    video, canvas { display: block; margin: auto; }
    #colorInfo { text-align: center; font-size: 20px; margin-top: 10px; }
  </style>
</head>
<body>
  <video id="video" width="400" autoplay></video>
  <canvas id="canvas" width="400" height="300" style="display:none;"></canvas>
  <div id="colorInfo">Detectando color...</div>

  <script>
    const video = document.getElementById('video');
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');
    const colorInfo = document.getElementById('colorInfo');

    // üé® Paleta extendida con m√°s tonos de naranja
    const colores = [
  // ROJOS
  { nombre: "Rojo brillante", r: 255, g: 0, b: 0 },
  { nombre: "Rojo oscuro", r: 139, g: 0, b: 0 },
  { nombre: "Rojo indio", r: 205, g: 92, b: 92 },
  { nombre: "Carmes√≠", r: 220, g: 20, b: 60 },
  { nombre: "Escarlata", r: 255, g: 36, b: 0 },
  { nombre: "Borgo√±a", r: 128, g: 0, b: 32 },
  { nombre: "Tomate", r: 255, g: 99, b: 71 },
  { nombre: "Coral", r: 255, g: 127, b: 80 },
  { nombre: "Rosa fuerte", r: 255, g: 20, b: 147 },
  { nombre: "Rosa claro", r: 255, g: 182, b: 193 },

  // NARANJAS
  { nombre: "Naranja brillante", r: 255, g: 165, b: 0 },
  { nombre: "Naranja oscuro", r: 255, g: 140, b: 0 },
  { nombre: "Mandarina", r: 255, g: 117, b: 24 },
  { nombre: "Durazno", r: 255, g: 204, b: 153 },
  { nombre: "√Åmbar", r: 255, g: 191, b: 0 },

  // AMARILLOS
  { nombre: "Amarillo", r: 255, g: 255, b: 0 },
  { nombre: "Oro", r: 255, g: 215, b: 0 },
  { nombre: "Caqui", r: 240, g: 230, b: 140 },
  { nombre: "Lim√≥n", r: 253, g: 233, b: 16 },
  { nombre: "Ma√≠z", r: 251, g: 236, b: 93 },

  // VERDES
  { nombre: "Verde", r: 0, g: 128, b: 0 },
  { nombre: "Verde claro", r: 144, g: 238, b: 144 },
  { nombre: "Verde lima", r: 0, g: 255, b: 0 },
  { nombre: "Verde menta", r: 152, g: 255, b: 152 },
  { nombre: "Verde esmeralda", r: 80, g: 200, b: 120 },

  // AZULES
  { nombre: "Azul", r: 0, g: 0, b: 255 },
  { nombre: "Azul claro", r: 173, g: 216, b: 230 },
  { nombre: "Azul real", r: 65, g: 105, b: 225 },
  { nombre: "Azul marino", r: 0, g: 0, b: 128 },
  { nombre: "Celeste", r: 135, g: 206, b: 235 },
  { nombre: "Turquesa", r: 64, g: 224, b: 208 },
  { nombre: "Cian", r: 0, g: 255, b: 255 },

  // MORADOS Y VIOLETAS
  { nombre: "P√∫rpura", r: 128, g: 0, b: 128 },
  { nombre: "Violeta", r: 238, g: 130, b: 238 },
  { nombre: "Lavanda", r: 230, g: 230, b: 250 },
  { nombre: "Magenta", r: 255, g: 0, b: 255 },

  // MARRONES Y NEUTROS
  { nombre: "Marr√≥n", r: 165, g: 42, b: 42 },
  { nombre: "Chocolate", r: 210, g: 105, b: 30 },
  { nombre: "Caf√©", r: 139, g: 69, b: 19 },
  { nombre: "Beige", r: 245, g: 245, b: 220 },
  { nombre: "Gris", r: 128, g: 128, b: 128 },
  { nombre: "Gris claro", r: 211, g: 211, b: 211 },
  { nombre: "Gris oscuro", r: 105, g: 105, b: 105 },
  { nombre: "Negro", r: 0, g: 0, b: 0 },
  { nombre: "Blanco", r: 255, g: 255, b: 255 }
];

    // üéØ Calcular promedio RGB
    function obtenerColorPromedio(data) {
      let totalR = 0, totalG = 0, totalB = 0;
      const pixels = data.data.length / 4;
      for (let i = 0; i < data.data.length; i += 4) {
        totalR += data.data[i];
        totalG += data.data[i + 1];
        totalB += data.data[i + 2];
      }
      return {
        r: Math.round(totalR / pixels),
        g: Math.round(totalG / pixels),
        b: Math.round(totalB / pixels)
      };
    }

    // üîç Color m√°s cercano
    function obtenerColorMasCercano(r, g, b) {
      let distanciaMinima = Infinity;
      let colorMasCercano = "Desconocido";
      colores.forEach(color => {
        const distancia = Math.sqrt(
          (color.r - r) ** 2 +
          (color.g - g) ** 2 +
          (color.b - b) ** 2
        );
        if (distancia < distanciaMinima) {
          distanciaMinima = distancia;
          colorMasCercano = color.nombre;
        }
      });
      return colorMasCercano;
    }

    // üì∑ Captura de video y an√°lisis 7x7
    navigator.mediaDevices.getUserMedia({ video: true })
      .then(stream => {
        video.srcObject = stream;
        video.addEventListener('play', () => {
          setInterval(() => {
            ctx.drawImage(video, 0, 0, canvas.width, canvas.height);
            const region = 7; // üëâ √Årea de 7x7 p√≠xeles
            const x = canvas.width / 2 - region / 2;
            const y = canvas.height / 2 - region / 2;
            const imageData = ctx.getImageData(x, y, region, region);
            const promedio = obtenerColorPromedio(imageData);
            const nombreColor = obtenerColorMasCercano(promedio.r, promedio.g, promedio.b);
            colorInfo.textContent = `Color: ${nombreColor} (RGB: ${promedio.r}, ${promedio.g}, ${promedio.b})`;
          }, 500);
        });
      })
      .catch(err => {
        console.error("Error al acceder a la c√°mara:", err);
      });
  </script>
</body>
</html>

